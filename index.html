<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Happy Birthday üíñ</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<style>
    #stars{
  position:fixed;
  inset:0;
  z-index:-2;       /* ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏á confetti (-1/-2) */
  pointer-events:none;
}
  :root{
    --bg:#0f0f14; --fg:#fff; --muted:#b9b9c9; --accent:#ff6aa2; --accent-2:#7aa7ff;
    --card:#171722; --radius:16px; --shadow:0 20px 60px rgba(0,0,0,.4);
    --cover:url('cover.jpg');
  }
  *{box-sizing:border-box} html,body{height:100%}
  body{
    margin:0; font-family:"Poppins",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:var(--fg);
    background:
      radial-gradient(1200px 600px at 80% -20%, #000000 0%, transparent 100%),
      radial-gradient(900px 600px at -10% 20%, #000000 0%, transparent 100%),
      linear-gradient(180deg, #111118 0%, #000000 100%);
    -webkit-font-smoothing:antialiased; line-height:1.6;
  }

  /* ====== Gate screens ====== */
  .gate{
    position: fixed; inset:0; z-index: 1000;
    display:grid; place-items:center; padding:28px 16px;
    background:
      radial-gradient(1000px 600px at 10% -10%, rgba(255,106,162,.18), transparent 60%),
      radial-gradient(900px 600px at 100% 20%, rgba(122,167,255,.18), transparent 60%),
      #0c0c12;
  }
  .gate-card{
    width:min(560px, 92vw);
    background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    border:1px solid rgba(255,255,255,.1);
    border-radius:16px; padding:24px 20px; text-align:center;
    box-shadow:var(--shadow); backdrop-filter: blur(8px);
  }
  .gate h1{margin:6px 0 8px; font-size:clamp(22px,4.2vw,28px)}
  .gate p{margin:0; color:#ddd}
  .tiles{display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-top:14px}
  .tile{
    background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
    border:1px solid rgba(255,255,255,.1); border-radius:12px; padding:14px 8px;
  }
  .tile .num{font-size:clamp(22px,6vw,30px); font-weight:800}
  .tile .lbl{font-size:12px; color:var(--muted)}
  .small{font-size:12px; color:var(--muted); margin-top:10px}
  .pass-wrap{display:grid; gap:12px; margin-top:16px}
  .code{
    letter-spacing:.4em; text-align:center;
    font: 700 22px/1 "Poppins",system-ui,sans-serif;
    padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.18);
    background:rgba(255,255,255,.06); color:#fff; outline:none;
  }
  .btn{
    border:none; border-radius:12px; padding:12px 14px; cursor:pointer; font-weight:800;
    background:linear-gradient(90deg, var(--accent), var(--accent-2)); color:#0b0b12;
    box-shadow:0 10px 30px rgba(0,0,0,.35);
  }
  .err{color:#ffd1e3; min-height:18px; font-size:13px}
  .shake{animation:shake .28s} @keyframes shake{0%,100%{transform:translateX(0)} 25%{transform:translateX(-6px)} 75%{transform:translateX(6px)}}

  /* ====== Main page ====== */
  .hero{min-height: 105svh; display:grid; place-items:center; text-align:center; padding: 110px 20px 150px; position:relative; overflow:hidden}
  .sparkle{position:absolute; inset:0; pointer-events:none; opacity:.6;
    background:
      radial-gradient(2px 2px at 20% 30%, #ffffff88 40%, transparent 41%),
      radial-gradient(2px 2px at 70% 20%, #ffffff66 40%, transparent 41%),
      radial-gradient(2px 2px at 40% 80%, #ffffff44 40%, transparent 41%),
      radial-gradient(2px 2px at 80% 70%, #ffffff55 40%, transparent 41%);
    mask-image: radial-gradient(70% 60% at 50% 40%, black 40%, transparent 100%);
    animation: twinkle 6s linear infinite;
  }
  @keyframes twinkle{50%{transform:translateY(10px); opacity:.8}}
  .headline{max-width:900px; margin:0 auto}
  .tag{display:inline-block; padding:8px 14px; border-radius:999px;
    background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#0b0b12; font-weight:700; letter-spacing:.4px;
    box-shadow:var(--shadow); margin-bottom:16px}
  h1{font-size:clamp(36px,6vw,72px); line-height:1.05; margin:10px 0 14px; font-weight:800; text-shadow:0 6px 40px rgba(255,106,162,.25)}
  .subtitle{color:var(--muted); font-size:clamp(16px,2.2vw,20px); margin:0 auto; max-width:700px}

  .container{max-width:980px; margin:-30px auto 80px; padding:0 20px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    border:1px solid rgba(255,255,255,.08); border-radius:16px; box-shadow:var(--shadow);
    padding:clamp(20px,4vw,40px); backdrop-filter:blur(8px)}
  .wish-title{font-size:clamp(22px,3vw,28px); margin:0 0 12px; font-weight:700}
  .wish p{margin:0 0 12px; color:#e9e9f7}
  .foot{text-align:center; color:var(--muted); margin-top:20px; font-size:13px}

  /* ====== Gallery: Portrait 9:16 ====== */
  .gallery{max-width:980px; margin:40px auto 200px; padding:0 20px}
  .gallery h2{margin:0 0 20px; font-size:clamp(20px,2.6vw,26px);text-align:center;}
  .carousel{
    position:relative; width:100%; max-width:700px;
    aspect-ratio: 9/16; margin:auto;
    background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
    border:1px solid rgba(255,255,255,.08); border-radius:16px; overflow:hidden; box-shadow:var(--shadow);
    user-select:none; touch-action:pan-y; box-sizing:border-box;
  }
  .slides{position:absolute; inset:0; perspective:1000px}
  .slide{
    position:absolute; top:50%; left:50%;
    width: 92%; max-width:100%;
    aspect-ratio: 9/16;
    transform:translate(-50%,-50%);
    border-radius:14px; overflow:hidden;
    box-shadow:0 20px 60px rgba(0,0,0,.45); border:1px solid rgba(255,255,255,.12);
    background:#111;
    transition: transform .35s ease, opacity .35s ease, filter .35s ease;
    will-change:transform,opacity,filter; cursor:pointer; box-sizing:border-box;
  }
  .slide > img, .slide > video{
    position:absolute; inset:0; width:100%; height:100%;
    object-fit: cover; object-position:center; display:block;
  }
  .nav{display:flex; gap:10px; justify-content:center; margin-top:14px;}
  .nav .btn{background:#fff; color:#111; font-weight:700}

  /* ====== Mini vinyl ====== */
  .mini-player{position:fixed; left:16px; bottom:16px; z-index:60; width:84px; height:84px; display:grid; place-items:center;
    backdrop-filter: blur(8px); border-radius: 16px; padding:8px;
    background: linear-gradient(180deg, rgba(21,21,29,.55), rgba(18,18,24,.55));
    border:1px solid rgba(255,255,255,.1); box-shadow:0 10px 30px rgba(0,0,0,.45);}
  .mini-deck{position:relative; width:68px; height:68px}
  .vinyl{position:absolute; inset:0; border-radius:999px;
    background: radial-gradient(circle at 50% 50%, #000 0 22%, transparent 22%),
               repeating-radial-gradient(circle at 50% 50%, #1b1b1f 0 1px, #121217 1px 2px), #101014;
    box-shadow: inset 0 0 0 3px rgba(255,255,255,.07), 0 6px 18px rgba(0,0,0,.5);
    animation:spin 6s linear infinite; animation-play-state: paused;}
  .vinyl::after{content:""; position:absolute; inset:22% 22%; border-radius:50%;
    background: radial-gradient(circle at 50% 45%, rgba(255,255,255,.35), transparent 60%), var(--cover);
    background-size:cover; background-position:center; box-shadow: inset 0 0 0 2px rgba(255,255,255,.18);}
  .spindle{position:absolute; left:50%; top:50%; width:6px; height:6px; border-radius:50%;
    transform:translate(-50%,-50%); background:#d7d7e2; box-shadow:0 0 0 2px rgba(0,0,0,.4), inset 0 0 2px #fff; z-index:2;}
  .tonearm{ position:absolute; width:68px; height:68px; right:-8px; top:-4px; pointer-events:none;}
  .arm{position:absolute; width:56px; height:3px; background:#c9c9cf; border-radius:2px; right:0; top:22px;
    transform-origin:52px 1.5px; transform: rotate(18deg); box-shadow: inset 0 0 3px rgba(0,0,0,.3); transition: transform .4s ease;}
  .head{ position:absolute; width:10px; height:7px; background:#eee; right:-4px; top:-2px; border-radius:2px; box-shadow:0 1px 2px rgba(0,0,0,.5) }
  .play-hit{ position:absolute; inset:0; border-radius:16px; cursor:pointer; }
  .playing .vinyl{animation-play-state: running} .playing .arm{transform: rotate(5deg)}
  @keyframes spin{to{transform:rotate(360deg)}}

  /* ====== Bottom section: Letters stack ====== */
  .letters-section{
    margin: 120px auto 220px;   /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤ ‚Äú‡∏¢‡∏≤‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‚Äù */
    padding: 0 20px; max-width: 980px;
  }
  .letters-wrap{
    background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    border: 1px solid rgba(255,255,255,.08); border-radius: 16px;
    padding: clamp(24px, 4vw, 40px); box-shadow: 0 20px 60px rgba(0,0,0,.35);
    backdrop-filter: blur(6px); text-align: center;
  }
  .letters-title{ margin: 0 0 4px; font-size: clamp(20px,2.6vw,26px) }
  .letters-sub{ margin: 0 0 16px; color: #cfcfe8 }
  .envelope-pile{
    position: relative; width: min(520px, 90vw); height: 180px; margin: 22px auto 0;
  }
  .envelope{
    position: absolute; left: 50%; top: 50%;
    transform: translate(-50%,-50%) rotate(-3deg);
    width: 220px; height: 140px; border-radius: 10px;
    background: linear-gradient(180deg, #f7f7fb, #ececf5);
    border: 1px solid rgba(0,0,0,.08);
    box-shadow: 0 14px 36px rgba(0,0,0,.25);
    cursor: pointer; transition: transform .2s ease, box-shadow .2s ease, filter .2s ease;
  }
  .envelope .seal{ position: absolute; right: 10px; bottom: 8px; font-size: 18px; opacity: .85; }
  .envelope:hover{ transform: translate(-50%,-52%) rotate(-2deg) scale(1.03); box-shadow: 0 20px 44px rgba(0,0,0,.3) }
  .envelope:active{ transform: translate(-50%,-50%) rotate(-2deg) scale(.99) }
  .env-2{ transform: translate(calc(-50% + 40px), calc(-50% + 8px)) rotate(6deg); background: linear-gradient(180deg, #f9f9ff,#efeff9)}
  .env-3{ transform: translate(calc(-50% - 42px), calc(-50% + 14px)) rotate(-10deg); background: linear-gradient(180deg, #f6f6fb,#ececf7)}

  /* Modal paper */
  .letter-modal{ position: fixed; inset: 0; z-index: 120; display: none; }
  .letter-modal.open{ display: block; }
  .letter-backdrop{
    position: absolute; inset: 0; background: rgba(8,8,12,.55); backdrop-filter: blur(2px);
    opacity: 0; transition: opacity .25s ease;
  }
  .letter-modal.open .letter-backdrop{ opacity: 1; }
  .paper{
    position: absolute; left: 50%; top: 50%;
    transform: translate(-50%,-50%) scale(.96);
    width: min(680px, 92vw);
    max-height: min(80vh, 820px);
    background: #fffdfa; color: #1d1d24;
    border-radius: 16px; box-shadow: 0 30px 80px rgba(0,0,0,.45);
    overflow: hidden; opacity: 0; transition: transform .28s ease, opacity .28s ease;
  }
  .letter-modal.open .paper{ opacity: 1; transform: translate(-50%,-50%) scale(1); }
  .paper.from-origin{
    transform: translate(calc(-50% + var(--fromX, 0)), calc(-50% + var(--fromY, 0))) scale(.85);
    opacity:.0;
  }
  .paper-inner{ padding: clamp(20px, 3.6vw, 36px) clamp(18px, 3.2vw, 30px); overflow: auto; max-height: inherit; }
  .paper-title{ margin: 0 0 10px; font: 800 clamp(18px,2.6vw,24px)/1.3 "Poppins",system-ui,sans-serif }
  .paper-content{ font-size: clamp(14px, 2.2vw, 17px); line-height: 1.8 }
  .paper-content p{ margin: 0 0 12px }
  .paper-close{
    position: absolute; right: 10px; top: 10px; width: 34px; height: 34px; border-radius: 50%;
    border: none; cursor: pointer; font: 800 20px/1 "Poppins",system-ui,sans-serif;
    color: #111; background: #fff; box-shadow: 0 6px 18px rgba(0,0,0,.18);
  }
  .paper-close:hover{ filter: brightness(0.96) }
  .paper-close:active{ transform: scale(.98) }

  @media (prefers-reduced-motion: reduce){
    .envelope, .paper, .letter-backdrop{ transition: none !important }
  }

  /* confetti canvas */
  #confetti{position:fixed; inset:0; pointer-events:none; z-index:70;}
</style>
</head>
<canvas id="stars"></canvas>
<body>

<!-- GATE: COUNTDOWN -->
<section class="gate" id="gate-count">
  <div class="gate-card">
    <div class="tag">‚è≥ Countdown</div>
    <h1>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡∏∞ ‡∏£‡∏≠‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡∏ô‡πâ‡∏≤</h1>
    <p>‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏∑‡∏ô‡∏õ‡∏∏‡πä‡∏ö ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏õ‡∏±‡πâ‡∏ö‡πÄ‡∏•‡∏≠‡∏≠</p>
    <div class="tiles" style="margin-top:14px">
      <div class="tile"><div class="num" id="cd-days">00</div><div class="lbl">Days</div></div>
      <div class="tile"><div class="num" id="cd-hours">00</div><div class="lbl">Hours</div></div>
      <div class="tile"><div class="num" id="cd-mins">00</div><div class="lbl">Minutes</div></div>
      <div class="tile"><div class="num" id="cd-secs">00</div><div class="lbl">Seconds</div></div>
    </div>
    <div class="small">‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô 14 ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô 2025 ‚Ä¢ 00:00</div>
  </div>
</section>

<!-- GATE: PASSCODE -->
<section class="gate" id="gate-pass" style="display:none">
  <div class="gate-card">
    <div class="tag">üîí Private</div>
    <h1>‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏•‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏π</h1>
    <p>‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏π‡∏ô‡πâ‡∏≤</p>
    <div class="pass-wrap">
      <input id="code" class="code" inputmode="numeric" maxlength="4" placeholder="‚Ä¢ ‚Ä¢ ‚Ä¢ ‚Ä¢" aria-label="Passcode">
      <button class="btn" id="btnGo">‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å</button>
      <div class="err" id="errMsg"></div>
    </div>
  </div>
</section>

<!-- MAIN PAGE -->
<main id="page" style="display:none">
  <canvas id="confetti"></canvas>

  <header class="hero">
    <div class="sparkle"></div>
    <div class="headline">
      <span class="tag">üåµ Happy Birthday</span>
      <h1>‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏ö‡∏µ‡πãüíñ</h1>
      <p class="subtitle">‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏ö‡∏ö‡∏µ‡πã ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å‡∏ï‡∏•‡∏≠‡∏î‡πÑ‡∏õ‡πÄ‡∏•‡∏¢ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏´‡∏ô‡∏π‡∏°‡∏µ‡πÅ‡∏ï‡πà‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏° ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞ ‡πÅ‡∏•‡∏∞‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏ô‡πâ‡∏≤‡∏≤</p>
    </div>
  </header>

  <section class="container">
    <div class="card wish">
        <h2 class="wish-title">My Letter to My Cactus üåµ</h2>
        <p>‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏∑‡πà‡∏ô... ‡∏õ‡∏µ‡πä‡πÜ ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏´‡∏ô‡∏π‡∏ü‡∏±‡∏á‡πÄ‡∏û‡∏•‡∏á‡πÇ‡∏õ‡∏£‡∏î‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏π‡πÑ‡∏õ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÜ ‡∏Å‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏ä‡πâ‡∏≤‡πÜ ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ö‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏õ‡∏µ‡πä‡πÜ ‡πÑ‡∏õ‡∏ô‡πâ‡∏≤<p>
        <p>‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡πÇ‡∏ï‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏≠‡∏µ‡∏Å‡∏õ‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÜ ‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏™‡∏°‡∏≠‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏î‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏¢‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏á ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏û‡∏≤‡∏Å‡∏±‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡πÑ‡∏î‡πâ ‡∏´‡∏ô‡∏π‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏•‡∏Å‡∏Ç‡∏≠‡∏á‡∏õ‡∏µ‡πä‡πÜ‡∏™‡∏î‡πÉ‡∏™‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å‡πÜ‡πÄ‡∏•‡∏¢</p>
        <p>‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏π <span class="emph">‡∏ä‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡πÉ‡∏Å‡∏•‡πâ‡∏Ç‡∏∂‡πâ‡∏ô</span> ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ ‡πÄ‡∏ä‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏∑‡∏°‡∏ï‡∏≤‡∏ï‡∏∑‡πà‡∏ô ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏π‡∏°‡∏µ‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡πÄ‡∏™‡∏°‡∏≠</p>
        <p>‡∏£‡∏±‡∏Å‡∏´‡∏ô‡∏π‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡πÄ‡∏Å‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏õ‡∏µ‡πä‡πÜ ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏£‡∏±‡∏Å‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡πÜ ‡πÄ‡∏•‡∏¢ ü§ç</p>
        <div class="foot">‚Äî from Thvt to Kvow</div>
    </div>
  </section>

  <!-- Gallery (Portrait 9:16) -->
  <section class="gallery">
    <h2>Our Moments üì∏</h2>
    <div class="carousel" id="carousel">
      <div class="slides" id="slides"></div>
    </div>
    <div class="nav">
      <button class="btn" id="prev">‚Üê Back</button>
      <button class="btn" id="next">Next ‚Üí</button>
  </section>

  <!-- Bottom: Letters stack -->
  <section class="letters-section" id="letters">
    <div class="letters-wrap">
      <h2 class="letters-title">‡∏°‡∏µ‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ô‡πÄ‡∏Å‡πà‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡πâ‡∏≤ ‚úâÔ∏è</h2>
      <p class="letters-sub">‡∏°‡∏µ‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡πà‡∏≤‡∏ô‡∏ô‡∏∞</p>
      <div class="envelope-pile">
        <button class="envelope" data-letter="0" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà 1"><span class="seal">üíó</span></button>
        <button class="envelope env-2" data-letter="1" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà 2"><span class="seal">üíå</span></button>
        <button class="envelope env-3" data-letter="2" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà 3"><span class="seal">üí´</span></button>
      </div>
    </div>
  </section>

  <!-- Modal: paper -->
  <div class="letter-modal" id="letterModal" aria-hidden="true">
    <div class="letter-backdrop" id="letterBackdrop"></div>
    <div class="paper" role="dialog" aria-modal="true" aria-labelledby="paperTitle">
      <button class="paper-close" id="paperClose" aria-label="‡∏õ‡∏¥‡∏î‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢">√ó</button>
      <div class="paper-inner">
        <h3 class="paper-title" id="paperTitle"></h3>
        <div class="paper-content" id="paperContent"></div>
      </div>
    </div>
  </div>

  <!-- Mini vinyl -->
  <div class="mini-player" id="miniPlayer" role="button" aria-label="‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á">
    <div class="mini-deck">
      <div class="vinyl"></div>
      <div class="spindle"></div>
      <div class="tonearm"><div class="arm"><div class="head"></div></div></div>
    </div>
    <div class="play-hit" id="playHit"></div>
    <audio id="audio" preload="metadata">
      <source src="song.mp3" type="audio/mpeg" />
    </audio>
  </div>
</main>

<script>
  /* ===== Config ===== */
  const BIRTHDAY_AT = new Date(2025, 8, 14, 0, 0, 0); // 14 ‡∏Å.‡∏¢. 2025 00:00
  const PASSCODE = "1409";
  const LS_KEY = "bd_unlocked_1409";

  // DEV override via URL
const params = new URLSearchParams(location.search);
const DEV_PREVIEW = params.has('preview');              // ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
const DEV_OPEN    = params.get('unlock') === PASSCODE;  // ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
const DEV_LOCK    = params.has('lock');                 // üîí ‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏•‡∏±‡∏ö

if (DEV_LOCK) {
  localStorage.removeItem('bd_unlocked_1409');
  // ‡∏ñ‡πâ‡∏≤‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡πÄ‡∏î‡πâ‡∏á‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ (‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡∏ñ‡πâ‡∏≤‡πÉ‡∏™‡πà‡∏ñ‡∏π‡∏Å)
  location.href = location.pathname; // ‡∏•‡∏ö‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà
} else if (DEV_OPEN) {
  localStorage.setItem('bd_unlocked_1409', '1');
}

  /* ===== Gate logic ===== */
  const gateCount = document.getElementById('gate-count');
  const gatePass  = document.getElementById('gate-pass');
  const page      = document.getElementById('page');

  const isUnlocked = localStorage.getItem(LS_KEY) === '1';
  if (isUnlocked || DEV_OPEN) {
    gateCount.style.display = 'none';
    gatePass.style.display  = 'none';
    page.style.display      = '';
  } else if (DEV_PREVIEW) {
    gateCount.style.display = 'none';
    gatePass.style.display  = '';
    page.style.display      = 'none';
  } else {
    decideGate();
    startCountdown();
  }

  function decideGate(){
    const now = new Date();
    const isPast = now >= BIRTHDAY_AT;
    gateCount.style.display = isPast ? 'none' : '';
    gatePass.style.display  = isPast ? '' : 'none';
    page.style.display      = 'none';
  }

  function startCountdown(){
    const dEl = document.getElementById('cd-days');
    const hEl = document.getElementById('cd-hours');
    const mEl = document.getElementById('cd-mins');
    const sEl = document.getElementById('cd-secs');
    function tick(){
      const now = new Date();
      let diff = BIRTHDAY_AT - now;
      if (diff <= 0){ decideGate(); return; }
      const sec = Math.floor(diff/1000) % 60;
      const min = Math.floor(diff/1000/60) % 60;
      const hr  = Math.floor(diff/1000/60/60) % 24;
      const day = Math.floor(diff/1000/60/60/24);
      dEl.textContent = String(day).padStart(2,'0');
      hEl.textContent = String(hr).padStart(2,'0');
      mEl.textContent = String(min).padStart(2,'0');
      sEl.textContent = String(sec).padStart(2,'0');
      requestAnimationFrame(tick);
    }
    tick();
  }

  // Passcode
  const codeInput = document.getElementById('code');
  const btnGo = document.getElementById('btnGo');
  const errMsg = document.getElementById('errMsg');
  btnGo?.addEventListener('click', tryUnlock);
  codeInput?.addEventListener('keydown', (e)=>{ if(e.key==='Enter') tryUnlock(); });
  function tryUnlock(){
    const v = (codeInput.value || '').replace(/\D/g,'');
    if (v === PASSCODE){
      localStorage.setItem(LS_KEY, '1');
      gatePass.style.display = 'none';
      page.style.display = '';
      shootConfetti(70);
    } else {
      errMsg.textContent = '‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ô‡πâ‡∏≤ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á üíó';
      codeInput.classList.remove('shake'); void codeInput.offsetWidth; codeInput.classList.add('shake');
      setTimeout(()=> codeInput.classList.remove('shake'), 320);
    }
  }

  /* ===== Mini vinyl ===== */
  const audio = document.getElementById('audio');
  const miniPlayer = document.getElementById('miniPlayer');
  const playHit = document.getElementById('playHit');
  let isPlaying=false;
  function setPlaying(on){ isPlaying = on; miniPlayer.classList.toggle('playing', on); }
  function togglePlay(){
    if(!isPlaying){ audio.play().then(()=>{ setPlaying(true); shootConfetti(50); })
      .catch(()=> alert('‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏•‡∏á‡∏ô‡∏∞ (‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)')); }
    else { audio.pause(); setPlaying(false); }
  }
  playHit.addEventListener('click', togglePlay);
  audio.addEventListener('pause', ()=> setPlaying(false));
  audio.addEventListener('play',  ()=> setPlaying(true));
  audio.addEventListener('ended', ()=> setPlaying(false));

  /* ===== Gallery (Portrait 9:16) ===== */
  const media = [
      { type:'image', src:'Pic/1.jpg', alt:'memory 1' },
      { type:'image', src:'Pic/2.jpg', alt:'memory 2' },
      { type:'image', src:'Pic/3.jpg', alt:'memory 3' },
      { type:'image', src:'Pic/4.jpg', alt:'memory 4' },
      { type:'image', src:'Pic/5.jpg', alt:'memory 5' },
      { type:'image', src:'Pic/6.jpg', alt:'memory 6' },
      { type:'image', src:'Pic/7.jpg', alt:'memory 7' },
      { type:'image', src:'Pic/8.jpg', alt:'memory 8' },
      { type:'video', src:'Pic/9.mp4', poster:'thumb1.jpg' },
      { type:'video', src:'Pic/10.mp4', poster:'thumb2.jpg' },
      { type:'video', src:'Pic/11.mp4', poster:'thumb3.jpg' },
      { type:'video', src:'Pic/12.mp4', poster:'thumb4.jpg' },
      { type:'video', src:'Pic/13.mp4', poster:'thumb5.jpg' },
      { type:'video', src:'Pic/14.mp4', poster:'thumb6.jpg' },
      { type:'image', src:'Pic/15.jpg', alt:'memory 15' },
      { type:'image', src:'Pic/16.jpg', alt:'memory 16' },
      { type:'image', src:'Pic/17.jpg', alt:'memory 17' },
      { type:'image', src:'Pic/18.jpg', alt:'memory 18' },
      { type:'image', src:'Pic/19.jpg', alt:'memory 19' },
      { type:'image', src:'Pic/20.jpg', alt:'memory 20' },
      { type:'image', src:'Pic/23.jpg', alt:'memory 23' },
      { type:'image', src:'Pic/24.jpg', alt:'memory 24' },
      { type:'image', src:'Pic/25.jpg', alt:'memory 25' },
      { type:'image', src:'Pic/26.jpg', alt:'memory 26' },
      { type:'image', src:'Pic/27.jpg', alt:'memory 27' },
      { type:'image', src:'Pic/28.jpg', alt:'memory 28' },
      { type:'image', src:'Pic/29.jpg', alt:'memory 29' },
      { type:'image', src:'Pic/30.jpg', alt:'memory 30' },
      { type:'image', src:'Pic/31.jpg', alt:'memory 31' },
      { type:'image', src:'Pic/32.jpg', alt:'memory 32' },
      { type:'image', src:'Pic/33.jpg', alt:'memory 33' },
      { type:'image', src:'Pic/34.jpg', alt:'memory 34' },
      { type:'image', src:'Pic/35.jpg', alt:'memory 35' },
    ];
  const slidesWrap = document.getElementById('slides');
  const prevBtn = document.getElementById('prev');
  const nextBtn = document.getElementById('next');

  function renderSlideItem(item, i){
    if (item.type === 'video') {
      const posterAttr = item.poster ? ` poster="${item.poster}"` : '';
      return `<video preload="metadata" muted playsinline loop ${posterAttr} src="${item.src}"></video>`;
    }
    const alt = item.alt || `memory ${i+1}`;
    return `<img src="${item.src}" alt="${alt}">`;
  }

  const slideEls = media.map((item, i)=>{
    const el = document.createElement('div');
    el.className = 'slide';
    el.innerHTML = renderSlideItem(item, i);
    el.addEventListener('click', ()=> focusIndex(i));
    slidesWrap.appendChild(el);
    return el;
  });

  let active = 0;
  function layout(){
    const n = media.length, baseX = 160; // portrait: ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡πÅ‡∏Ñ‡∏ö‡∏•‡∏á
    for (let i=0;i<n;i++){
      let d = (i - active + n) % n; if (d > n/2) d -= n;
      const depth = Math.abs(d);
      const x = d * baseX;
      const scale = 1 - Math.min(depth * 0.10, 0.40); // ‡∏Å‡∏•‡∏≤‡∏á‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
      const opacity = 1 - Math.min(depth * 0.18, 0.7);
      const z = 100 - depth;
      const el = slideEls[i];
      el.style.zIndex = z;
      el.style.opacity = opacity.toFixed(3);
      el.style.filter = depth ? 'blur(0.3px) saturate(0.9)' : 'none';
      el.style.transform = `translate(-50%,-50%) translateX(${x}px) translateZ(0) scale(${scale.toFixed(3)}) rotateY(${d*2}deg)`;
    }
    updateAutoplay();
  }
  function updateAutoplay(){
    for (let i=0; i<slideEls.length; i++){
      const v = slideEls[i].querySelector('video');
      if (!v) continue;
      try{
        if(i===active){ v.muted = true; v.playsInline = true; v.loop = true; const p = v.play(); if(p?.catch) p.catch(()=>{}); }
        else { v.pause(); v.currentTime = 0; }
      }catch(e){}
    }
  }
  function next(){ active = (active + 1) % media.length; layout(); }
  function prev(){ active = (active - 1 + media.length) % media.length; layout(); }
  function focusIndex(i){
    const n = media.length; let diff = (i - active + n) % n; if (diff > n/2) diff -= n;
    active = (active + diff + n) % n; layout();
  }
  prevBtn.addEventListener('click', prev);
  nextBtn.addEventListener('click', next);
  addEventListener('keydown', e=>{ if(e.key==='ArrowRight') next(); if(e.key==='ArrowLeft') prev(); });

  (function enableDragSwipe(container){
    let startX = 0, dx = 0, dragging = false;
    const start = x => { dragging = true; startX = x; dx = 0; container.style.cursor='grabbing'; };
    const move  = x => {
      if(!dragging) return; dx = x - startX;
      const n=media.length;
      for(let i=0;i<n;i++){
        let d = (i - active + n) % n; if(d>n/2) d-=n;
        const previewX = d*160 + dx*0.35; // ‡πÉ‡∏´‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á baseX
        const depth=Math.abs(d); const scale = 1 - Math.min(depth*0.10,0.40);
        slideEls[i].style.transform = `translate(-50%,-50%) translateX(${previewX}px) scale(${scale.toFixed(3)})`;
      }
    };
    const end   = () => {
      if(!dragging) return; dragging = false; container.style.cursor='default';
      if (dx < -60) next(); else if (dx > 60) prev(); else layout();
    };
    container.addEventListener('mousedown', e=> start(e.clientX));
    container.addEventListener('mousemove', e=> move(e.clientX));
    container.addEventListener('mouseup', end);
    container.addEventListener('mouseleave', end);
    container.addEventListener('touchstart', e=> start(e.touches[0].clientX), {passive:true});
    container.addEventListener('touchmove', e=> move(e.touches[0].clientX), {passive:true});
    container.addEventListener('touchend', end);
  })(document.getElementById('carousel'));

  layout();

  /* ===== Letters modal ===== */
  const LETTERS = [
    { title: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏±‡∏á‡πÄ‡∏≠‡∏¥‡∏ç‡∏ó‡∏µ‡πà‡∏á‡∏î‡∏á‡∏≤‡∏°", html: `<p>‡∏´‡∏ô‡∏π‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏±‡∏á‡πÄ‡∏≠‡∏¥‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡πá‡∏Å‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢‡∏Ñ‡∏ô‡∏ô‡∏∂‡∏á ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡πä‡πÜ‡πÑ‡∏î‡πâ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏´‡∏ô‡∏π ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡∏ô‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</p><p>‡∏ñ‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏±‡∏Å‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÑ‡∏ß‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏â‡∏±‡∏ô‡∏à‡∏∞‡∏Ñ‡πà‡∏≠‡∏¢ ‡πÜ ‡πÇ‡∏≠‡∏ö‡∏Å‡∏≠‡∏î‡∏°‡∏±‡∏ô‡πÑ‡∏ß‡πâ‡πÄ‡∏≠‡∏á‡∏ô‡∏∞ ü§ç</p>` },
    { title: "‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏°", html: `<p>‡∏õ‡∏µ‡πä‡∏ä‡∏≠‡∏ö‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏π‡∏¢‡∏¥‡πâ‡∏°‡∏°‡∏≤‡∏Å‡πÜ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÇ‡∏•‡∏Å‡∏õ‡∏µ‡πä‡πÜ‡∏°‡∏±‡∏ô‡∏™‡∏î‡πÉ‡∏™‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</p><p>‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡πÄ‡∏ò‡∏≠‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á ‡∏à‡∏∞‡∏¢‡∏¥‡πâ‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÄ‡∏®‡∏£‡πâ‡∏≤ ‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏Å‡πá‡∏¢‡∏±‡∏á‡∏à‡∏∞‡∏°‡∏µ‡∏õ‡∏µ‡πä‡πÜ‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÜ ‡πÄ‡∏™‡∏°‡∏≠‡πÄ‡∏•‡∏¢‡∏ô‡πâ‡∏≤</p>` },
    { title: "‡∏à‡∏∏‡πä‡∏ö‡πÜ‡πÜ‡πÜ", html: `<p>‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡πÑ‡∏õ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ó‡∏≥‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏à‡∏∞‡πÄ‡∏ï‡πâ‡∏ô‡πÑ‡∏õ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÜ‡∏Å‡∏±‡∏ô</p><p>‡∏£‡∏±‡∏Å‡∏´‡∏ô‡∏π‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ üíå</p>` }
  ];
  const modalEl   = document.getElementById('letterModal');
  const backdrop  = document.getElementById('letterBackdrop');
  const btnClose  = document.getElementById('paperClose');
  const paperTitle= document.getElementById('paperTitle');
  const paperCont = document.getElementById('paperContent');
  const envelopeBtns = Array.from(document.querySelectorAll('.envelope'));
  let lastFocused = null;

  function openLetter(index=0, fromBtn=null){
    const data = LETTERS[index] || LETTERS[0];
    paperTitle.textContent = data.title || "‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢";
    paperCont.innerHTML = data.html || "";
    lastFocused = document.activeElement;

    // ‡∏ã‡∏π‡∏°‡∏à‡∏≤‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ã‡∏≠‡∏á
    if (fromBtn){
      const r = fromBtn.getBoundingClientRect();
      const cx = r.left + r.width/2;
      const cy = r.top + r.height/2;
      const vw = window.innerWidth, vh = window.innerHeight;
      const dx = cx - vw/2, dy = cy - vh/2;
      const paper = modalEl.querySelector('.paper');
      paper.style.setProperty('--fromX', `${dx}px`);
      paper.style.setProperty('--fromY', `${dy}px`);
      paper.classList.add('from-origin');
    }

    modalEl.classList.add('open');
    modalEl.setAttribute('aria-hidden','false');
    btnClose.focus();
    document.documentElement.style.overflow = 'hidden';

    setTimeout(()=>{
      const paper = modalEl.querySelector('.paper');
      paper.classList.remove('from-origin');
      paper.style.removeProperty('--fromX');
      paper.style.removeProperty('--fromY');
    }, 320);
  }
  function closeLetter(){
    modalEl.classList.remove('open');
    modalEl.setAttribute('aria-hidden','true');
    document.documentElement.style.overflow = '';
    if (lastFocused && typeof lastFocused.focus === 'function') lastFocused.focus();
  }
  envelopeBtns.forEach(btn=>{
    btn.addEventListener('click', ()=>{ const idx = parseInt(btn.dataset.letter || '0', 10); openLetter(idx, btn); });
  });
  btnClose.addEventListener('click', closeLetter);
  backdrop.addEventListener('click', closeLetter);
  document.addEventListener('keydown', (e)=>{ if (e.key === 'Escape' && modalEl.classList.contains('open')) closeLetter(); });

  /* ===== Confetti ===== */
  const conf=document.getElementById('confetti'); const ctx=conf.getContext('2d'); let W,H,confs=[];
  function resize(){ W=conf.width=innerWidth; H=conf.height=innerHeight } addEventListener('resize',resize); resize();
  function shootConfetti(n=60){
    const colors=['#ff6aa2','#7aa7ff','#ffd166','#baffc9','#caffbf','#fdb6d0'];
    for(let i=0;i<n;i++){
      confs.push({x:W/2+(Math.random()-0.5)*W*0.4, y:-20, r:4+Math.random()*6, vx:(Math.random()-0.5)*3, vy:2+Math.random()*3.5, a:Math.random()*Math.PI*2, va:(Math.random()-0.5)*0.2, color:colors[Math.floor(Math.random()*colors.length)]});
    }
  }
  (function tick(){ ctx.clearRect(0,0,W,H);
    for(let i=confs.length-1;i>=0;i--){
      const c=confs[i]; c.x+=c.vx; c.y+=c.vy; c.a+=c.va;
      ctx.save(); ctx.translate(c.x,c.y); ctx.rotate(c.a); ctx.fillStyle=c.color; ctx.fillRect(-c.r,-c.r,c.r*2,c.r*2); ctx.restore();
      if(c.y>H+30) confs.splice(i,1);
    }
    requestAnimationFrame(tick);
  })();
  
  /* ===== Floating stars background ===== */
const starCanvas = document.getElementById("stars");
const starCtx = starCanvas.getContext("2d");
let SW, SH, stars=[];

function resizeStars(){
  SW = starCanvas.width = innerWidth;
  SH = starCanvas.height = innerHeight;
  stars = Array.from({length: 60}, ()=> makeStar()); // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≤‡∏ß 60 ‡∏î‡∏ß‡∏á (‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ)
}
function makeStar(){
  return {
    x: Math.random()*SW,
    y: Math.random()*SH,
    size: 12 + Math.random()*28,              // ‡∏Ç‡∏ô‡∏≤‡∏î‡∏î‡∏≤‡∏ß 12‚Äì40px
    speedX: (Math.random()-0.5)*0.2,          // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô
    speedY: (Math.random()-0.5)*0.2,          // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á
    opacity: 0.3 + Math.random()*0.7,         // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™
    emoji: Math.random()<0.5 ? "‚≠ê" : "üíñ"     // ‡∏™‡∏•‡∏±‡∏ö emoji ‡∏î‡∏≤‡∏ß
  };
}
function tickStars(){
  starCtx.clearRect(0,0,SW,SH);
  for (let s of stars){
    starCtx.globalAlpha = s.opacity;
    starCtx.font = `${s.size}px serif`;
    starCtx.fillText(s.emoji, s.x, s.y);
    // ‡∏Ç‡∏¢‡∏±‡∏ö
    s.x += s.speedX;
    s.y += s.speedY;
    // ‡∏ß‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡∏à‡∏≠
    if (s.x<-50) s.x=SW+20;
    if (s.x>SW+50) s.x=-20;
    if (s.y<-50) s.y=SH+20;
    if (s.y>SH+50) s.y=-20;
  }
  requestAnimationFrame(tickStars);
}
addEventListener("resize", resizeStars);
resizeStars();
tickStars();

</script>
</body>
</html>
